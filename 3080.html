<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>EYES OF 3080</title>

<!-- Site Description for SEO -->
<meta name="description" content="EYES OF 3080 - Stay connected with real updates and growth in UNIOSUN.">

<!-- Favicon -->
<link rel="icon" type="image/png" href="https://vtpsruejncfykiazrfsx.supabase.co/storage/v1/object/public/PRODUCTS/EYES%20OF%203080%20logo.png">

<!-- Open Graph / Facebook -->
<meta property="og:title" content="EYES OF 3080">
<meta property="og:description" content="We keep students connected, share real updates, and inspire one another to grow in UNIOSUN.">
<meta property="og:image" content="https://vtpsruejncfykiazrfsx.supabase.co/storage/v1/object/public/PRODUCTS/EYES%20OF%203080%20logo.png">
<meta property="og:url" content="https://campusmates12.github.io/EYES-OF-3080/3080.html">
<meta property="og:type" content="website">

<!-- Twitter -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="EYES OF 3080">
<meta name="twitter:description" content="We keep students connected, share real updates, and inspire one another to grow in UNIOSUN.">
<meta name="twitter:image" content="https://vtpsruejncfykiazrfsx.supabase.co/storage/v1/object/public/PRODUCTS/EYES%20OF%203080%20logo.png">

<style>
  :root {
    --uni-green:#0a5a2b;
    --uni-green-2:#155e36;
    --text:#0e0e0e;
    --muted:#5f6b5f;
    --surface:#ffffff;
    --dark-bg:#121212;
    --dark-surface:#1e1e1e;
    --dark-text:#e0e0e0;
  }
  body { margin:0; font-family:Arial, sans-serif; background:#fff; color:var(--text); }

  /* DARK MODE */
  body.dark { background:var(--dark-bg); color:var(--dark-text); }
  body.dark .card { background:var(--dark-surface); border-color:#333; }
  body.dark nav { background:#222; }
  body.dark nav a { color:#ddd; }
  body.dark nav a:hover { color:#4caf50; }
  body.dark .topbar { background:#222; }
  body.dark footer { background:#111; }

  /* HEADER */
  .topbar { background:var(--uni-green); color:#fff; padding:16px; display:flex; justify-content:space-between; align-items:center; }
  .brand { display:flex; align-items:center; gap:12px; }
  .brand img { width:50px; height:50px; border-radius:50%; background:#fff; }
  .brand h1 { margin:0; font-size:22px; }

  .actions { display:flex; gap:10px; align-items:center; }
  .hamburger { display:flex; flex-direction:column; gap:4px; cursor:pointer; }
  .hamburger span { width:24px; height:3px; background:#fff; border-radius:2px; }
  .mode-toggle { background:#fff; color:var(--uni-green); border:none; border-radius:6px; padding:6px 10px; cursor:pointer; }

  /* NAVIGATION */
  nav { background:#eee; }
  nav ul { list-style:none; display:flex; gap:14px; padding:10px; margin:0; }
  nav a { color:#000; text-decoration:none; font-weight:500; cursor:pointer; }
  nav a:hover { color:var(--uni-green); }

  @media(max-width:700px){
    nav ul { flex-direction:column; display:none; }
    nav ul.active { display:flex; }
  }

  /* SEARCH */
  .search { max-width:400px; margin:16px auto; }
  .search input { width:100%; padding:10px 14px; border-radius:8px; border:1px solid #ccc; }

  /* GRID */
  .grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(280px,1fr)); gap:16px; margin:20px 0; padding:0 16px; }
  .card { background:var(--surface); border:1px solid #eee; padding:16px; border-radius:10px; box-shadow:0 2px 6px rgba(0,0,0,0.05); }
  .card h3 { margin:0 0 10px; font-size:18px; }
  .card p { color:var(--muted); margin-bottom:12px; }
  .btn { background:var(--uni-green-2); color:#fff; border:none; padding:8px 14px; border-radius:6px; cursor:pointer; }

  /* SINGLE POST */
  #postDetail { display:none; max-width:800px; margin:20px auto; padding:16px; }
  #postDetail h1 { font-size:26px; }
  #postDetail img { width:100%; border-radius:8px; margin:16px 0; }
  .back-btn { cursor:pointer; color:var(--uni-green); margin-bottom:15px; display:inline-block; }

body { 
  font-family: Arial, sans-serif; 
  padding: 20px; 
  line-height: 1.6; 
  color: #222; 
  position: relative; 
}

.watermark {
  position:fixed;
  top:50%;
  left:50%;
  transform:translate(-50%, -50%) rotate(-45deg);
  font-size:80px;
  color:rgba(0, 100, 0, 0.15);
  z-index:0;
  pointer-events:none;
  white-space: nowrap;
}

#detailTitle {
  display: inline-block;
  border-top: 3px solid var(--uni-green, #006400);
  border-bottom: 3px solid var(--uni-green, #006400);
  padding: 6px 0; /* space inside between top/bottom lines */
  margin: 12px 0;
}

  /* SHARE ICONS */
  .share-section { margin-top:20px; display:flex; align-items:center; gap:12px; }
  .share-section span { font-weight:bold; }
  .share-icons a { text-decoration:none; font-size:22px; }
  .share-icons a:hover { opacity:0.7; }

.card-header {
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:10px;
}
.card-header h3 {
  margin:0;
  font-size:18px;
  flex:1;
}
.share-icon img {
  width:20px;
  height:20px;
  cursor:pointer;
}
.share-icon img:hover { opacity:0.7; }

html, body {
  margin: 0;
  padding: 0;
  overflow-x: hidden; /* hides horizontal scroll */
}

* {
  box-sizing: border-box; /* prevents padding/margin from pushing things out */
}
#detailTitle {
  display: flex;
  align-items: center;
  gap: 10px;
  font-size: 20px;
  font-weight: bold;
}

#detailTitle .title-share-icon {
  width: 22px;
  height: 22px;
  cursor: pointer;
}
#detailContent p {
  margin: 12px 0;
  line-height: 1.6;
}

/* General style */
select.grade-select {
  appearance: none;
  -webkit-appearance: none;
  -moz-appearance: none;

  background: #f5f8ff url("https://cdn-icons-png.flaticon.com/512/271/271210.png") no-repeat right 12px center;
  background-size: 14px;
  border: 2px solid #0077ff;
  border-radius: 8px;
  padding: 10px 36px 10px 12px;
  font-size: 15px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.3s ease;
}

/* Default */
select.grade-select { color: #333; }

/* Color mappings */
select.grade-select.a1, select.grade-select.a { background-color: #d4f8d4; color: #1a7a1a; font-weight: 600; }
select.grade-select.b2, select.grade-select.b { background-color: #dceeff; color: #0047cc; font-weight: 600; }
select.grade-select.c3, select.grade-select.c { background-color: #fff3d4; color: #a06000; font-weight: 600; }
select.grade-select.f9, select.grade-select.f { background-color: #ffe0e0; color: #b00000; font-weight: 600; }


/* ============================
   PROFILE MODAL STYLING (Green Theme)
============================ */

.profile-page {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.6); /* semi-transparent overlay */
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 1000;
}

.profile-container {
  background: #0f3d0f; /* deep green background */
  color: #e6f4ea;       /* light text */
  padding: 30px;
  border-radius: 12px;
  width: 350px;
  max-width: 90%;
  box-shadow: 0 8px 25px rgba(0,0,0,0.5);
  text-align: center;
  position: relative;
  font-family: 'Arial', sans-serif;
}

.close-profile {
  position: absolute;
  top: 10px;
  right: 15px;
  background: transparent;
  border: none;
  font-size: 22px;
  color: #e6f4ea;
  cursor: pointer;
}

.profile-header img {
  width: 80px;
  height: 80px;
  border-radius: 50%;
  margin-bottom: 15px;
  border: 2px solid #39b54a; /* green accent */
}

.profile-header h2 {
  margin: 5px 0;
  font-size: 22px;
}

.profile-header p {
  font-size: 14px;
  color: #cde5d0;
}

.profile-actions {
  margin-top: 20px;
  display: flex;
  justify-content: space-around;
}

.profile-actions button {
  padding: 8px 18px;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  font-weight: bold;
  transition: all 0.2s ease-in-out;
}

.profile-actions button:nth-child(1) {
  background: #39b54a; /* Edit Profile button green */
  color: #fff;
}

.profile-actions button:nth-child(1):hover {
  background: #2e8b3a;
}

.profile-actions button:nth-child(2) {
  background: #ff4d4f; /* Logout stays red */
  color: #fff;
}

.profile-actions button:nth-child(2):hover {
  background: #c40000;
}

.profile-info {
  margin-top: 25px;
  text-align: left;
}

.profile-info h3 {
  margin-bottom: 10px;
  color: #39b54a; /* section header green */
}

.profile-info ul {
  list-style: none;
  padding-left: 0;
}

.profile-info ul li {
  padding: 5px 0;
  border-bottom: 1px solid #2e8b3a; /* subtle green line */
  font-size: 14px;
}

  /* COUNTER SECTION */
  .stats-section { background:var(--uni-green); color:#fff; padding:50px 20px; text-align:center; }
  .stats-container { display:flex; flex-wrap:wrap; justify-content:center; max-width:1000px; margin:auto; gap:30px; }
  .stat-box { flex:1; min-width:200px; }
  .stat-box h2 { font-size:2.5rem; margin:0; font-weight:bold; }
  .stat-box p { margin:10px 0 0; font-size:1.1rem; }


  /* FOOTER */
  footer { background:var(--uni-green); color:#fff; padding:30px 16px; text-align:center; }

  /* HIDE SECTIONS */
  .page-section { display:none; }
</style>

<!-- FontAwesome -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
l
</head>
<body>

<!-- HEADER -->
<div class="topbar">
  <div class="brand">
    <img src="https://i.postimg.cc/mD4BWXCk/6a8f3e57-3d27-47f5-9b5e-22a7070fc442.jpg" alt="Logo">
    <h1>EYES OF 3080</h1>
  </div>
  <div class="actions">
    <div class="hamburger" onclick="toggleMenu()"><span></span><span></span><span></span></div>
    <button class="mode-toggle" onclick="toggleDarkMode()">üåô</button>
  </div>
</div>



<!-- ============================
     NAVIGATION
============================ -->
<nav>
  <ul class="menu" id="menu">
    <li><a onclick="showSection('home')">Home</a></li>
    <li><a onclick="showSection('gaming')">Gaming</a></li>
    <li><a onclick="showSection('pdfs')">PDFs</a></li>
    <li><a onclick="showSection('anonymous')">Anonymous</a></li>
    <li><a onclick="showSection('uniosun-login-help')">UNIOSUN LOGIN HELP</a></li>
    <li><a onclick="showSection('calculators')">Calculators</a></li>
    <li><a onclick="showSection('marketplace')">MarketplaceüõçÔ∏è</a></li>
    <li><a onclick="toggleProfile()">Profile üëÅÔ∏è‚Äçüó®Ô∏è</a></li>
  </ul>
</nav>




      

<!-- MAIN SECTIONS -->
<main>
  <!-- HOME -->
  <section id="home" class="page-section">

    <!-- News Headlines Header -->
    <h2 class="headline-title">  HEADLINES</h2>

    <div class="search">
      <input type="search" id="searchInput" placeholder="Search news..." onkeyup="searchNews()" />
    </div>


  <section id="newsGrid" class="grid">
    <article class="card">
      <div class="card-header">
        <h3>üì¢ 2025/2026 UNIOSUN JUPEB Entrance Examination</h3>
        <a href="#" class="share-icon" onclick="sharePost('copy')">
          <img src="https://cdn-icons-png.flaticon.com/512/3466/3466003.png" alt="Share" />
        </a>
      </div>
      <p>This is to invite you for the JUPEB entrance examination‚Ä¶</p>
      <button class="btn" onclick="openPost(1)">Read More</button>
    </article>

    <article class="card">
      <div class="card-header">
        <h3>SCREENING RESULT NOTICE</h3>
        <a href="#" class="share-icon" onclick="sharePost('copy')">
          <img src="https://cdn-icons-png.flaticon.com/512/3466/3466003.png" alt="Share" />
        </a>
      </div>
      <p>Be informed that immediately the admission form closes, you will see your screening result‚Ä¶</p>
      <button class="btn" onclick="openPost(2)">Read More</button>
    </article>
  </section>
</section>

<!-- ============================
     PROFILE MODAL
============================ -->
<div id="profilePage" class="profile-page">
  <div class="profile-container">
    <!-- Close Button -->
    <button class="close-profile" onclick="toggleProfile()">‚úñ</button>

    <!-- Profile Header -->
    <div class="profile-header">
      <img src="https://vtpsruejncfykiazrfsx.supabase.co/storage/v1/object/public/PRODUCTS/EYES%20OF%203080%20logo" 
           alt="Eyes of 3080 Logo" class="profile-logo">
      <h2 id="profileName">User Name</h2>
      <p id="profileEmail">user@example.com</p>
      <p id="profileCreated">Member since: ...</p>
    </div>

    <!-- Profile Actions -->
    <div class="profile-actions">
      <button onclick="editProfile()">Edit Profile</button>
      <button onclick="logoutUser()">Logout</button>
    </div>

    <!-- Friends Section -->
    <div class="profile-connections" style="margin-top:25px; text-align:left;">
      <h3 style="color:#39b54a;">FRIENDS LIST</h3>
      <div style="margin-top:10px;">
        <button 
          style="padding: 8px 15px; border-radius: 6px; border: none; background-color: #39b54a; color: #fff; cursor: pointer; font-weight: bold;"
          onclick="window.location.href='connections.html'">
          View friends list
        </button>
      </div>
    </div>
  </div>
</div>




<!-- CALCULATORS SECTION -->
<section id="calculators" class="page-section" style="padding:20px;">
  <h2>üìä UNIOSUN Calculators</h2>

  <div class="tabs">
    <button class="btn" onclick="showCalc('cgpaCalc')">GPA / CGPA Calculator</button>
    <button class="btn" onclick="showCalc('aggCalc')">Aggregate Calculator</button>
  </div>

  <!-- GPA / CGPA CALCULATOR -->
  <div id="cgpaCalc" class="calc-box">
    <h3>üéì GPA / CGPA Calculator (5.0 Scale)</h3>

    <!-- SEMESTER 1 -->
    <h4>Semester 1</h4>
    <div id="semester1"></div>
    <button class="btn" onclick="addCourse('semester1')">+ Add Course</button>

    <!-- SEMESTER 2 -->
    <h4>Semester 2</h4>
    <div id="semester2"></div>
    <button class="btn" onclick="addCourse('semester2')">+ Add Course</button>

    <br><br>
    <button class="btn" onclick="calculateCGPA()">Calculate GPA & CGPA</button>
    <p id="cgpaResult"></p>
  </div>

  <!-- AGGREGATE CALCULATOR -->
  <div id="aggCalc" class="calc-box" style="display:none;">
    <h3>üìå UNIOSUN Aggregate Calculator</h3>

    <!-- JAMB -->
    <label>Enter JAMB Score (out of 400):</label>
    <input type="number" id="jambScore" placeholder="e.g. 210" />

    <!-- O'LEVEL -->
    <h4>Enter 5 O‚ÄôLevel Grades</h4>
    <div id="olevelGrades"></div>
    <button class="btn" onclick="addOlevelInputs()">+ Add O‚ÄôLevel Subjects</button>

    <br><br>
    <button class="btn" onclick="calculateAggregate()">Calculate Screening Score</button>
    <p id="aggResult"></p>
  </div>
</section>


<!-- Floating Bot Button -->
<div id="chat-toggle" onclick="toggleChat()">
  <img src="https://vtpsruejncfykiazrfsx.supabase.co/storage/v1/object/public/PRODUCTS/EYES%20OF%203080%20logo" alt="Bot" />
  <span class="bot-icon">ü§ñ</span>
</div>

<!-- Floating Chatbot -->
<div id="chatbot" style="display:none;">
  <div id="chat-header">
    <span>EYES OF 3080 ASSISTANT ü§ñ</span>
    <button id="chat-close" onclick="toggleChat()">‚àí</button>
  </div>
  <div id="chat-body">
    <div id="chat-messages"></div>
    <div class="chat-input-box">
      <input type="text" id="chat-input" placeholder="Ask me anything..." onkeypress="handleChat(event)">
      <button onclick="sendChat()">‚û§</button>
    </div>
  </div>
</div>

<style>
  /* Floating toggle button */
  #chat-toggle {
    position: fixed;
    bottom: 20px;
    right: 20px;
    background: #006400;
    border-radius: 50%;
    width: 55px;
    height: 55px;
    display: flex;
    justify-content: center;
    align-items: center;
    box-shadow: 0px 4px 10px rgba(0,0,0,0.3);
    cursor: pointer;
    z-index: 9999;
  }
  #chat-toggle img {
    width: 35px;
    height: 35px;
    border-radius: 50%;
  }

    .logo-bot {
    position: relative;
    display: inline-block;
    width: 70px; /* adjust size */
    height: 70px;
  }
  .main-logo {
    width: 100%;
    border-radius: 50%;
  }
  .bot-icon {
    position: absolute;
    bottom: -5px;
    right: -5px;
    background: #006400;
    color: white;
    font-size: 16px;
    padding: 4px;
    border-radius: 50%;
    border: 2px solid white;
  }



  /* Chatbox */
  #chatbot {
    position: fixed;
    bottom: 85px;
    right: 20px;
    width: 320px;
    height: 420px;
    background: #fff;
    border-radius: 12px;
    box-shadow: 0px 4px 10px rgba(0,0,0,0.25);
    font-family: Arial, sans-serif;
    display: flex;
    flex-direction: column;
    z-index: 9999;
  }
  #chat-header {
    background: #006400;
    color: #fff;
    padding: 10px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-radius: 12px 12px 0 0;
    font-weight: bold;
    font-size: 14px;
  }
  #chat-header button {
    background: transparent;
    border: none;
    color: #fff;
    font-size: 18px;
    cursor: pointer;
  }
  #chat-body {
    flex: 1;
    display: flex;
    flex-direction: column;
    background: #f9f9f9;
  }
  #chat-messages {
    flex: 1;
    padding: 10px;
    overflow-y: auto;
    font-size: 14px;
  }
  .msg {
    max-width: 80%;
    padding: 8px 12px;
    margin: 5px 0;
    border-radius: 12px;
    line-height: 1.4;
    clear: both;
    display: inline-block;
  }
  .user {
    background: #006400;
    color: #fff;
    float: right;
    border-bottom-right-radius: 0;
  }
  .bot {
    background: #e5e5e5;
    color: #222;
    float: left;
    border-bottom-left-radius: 0;
  }
  .chat-input-box {
    display: flex;
    border-top: 1px solid #ccc;
  }
  #chat-input {
    flex: 1;
    border: none;
    padding: 10px;
    font-size: 14px;
    outline: none;
  }
  .chat-input-box button {
    border: none;
    background: #006400;
    color: white;
    padding: 10px 15px;
    cursor: pointer;
    border-radius: 0 0 12px 0;
  }
</style>

<!-- üéÆ GAMING ZONE -->
<section id="gaming" class="page-section" style="display:none;">
  <h2 class="section">üéÆ Gaming Zone</h2>

  <style>
    /* ===== Gaming Zone Styles ===== */
    #gaming {
      padding: 20px;
      background: #f9f9f9;
      border-radius: 8px;
    }

    #gaming h2.section {
      color: var(--uni-green);
      text-align: center;
      margin-bottom: 25px;
    }

    #gaming .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 20px;
    }

    #gaming .card {
      background: #fff;
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
      transition: transform 0.2s ease;
    }

    #gaming .card:hover {
      transform: translateY(-3px);
    }

    #gaming .card h3 {
      margin: 10px 0;
      color: var(--uni-green);
    }

    #gaming form input {
      flex: 1;
      padding: 10px;
      border-radius: 8px;
      border: 1px solid #ccc;
    }

    #gaming form button {
      padding: 10px 15px;
      border-radius: 8px;
      border: none;
      background: var(--uni-green);
      color: #fff;
      cursor: pointer;
      transition: background 0.3s;
    }

    #gaming form button:hover {
      background: var(--uni-green-2);
    }

    /* Username button style (Option 2) */
    #gaming ul {
      margin-top: 12px;
      padding-left: 0;
      list-style: none;
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    #gaming ul li {
      display: inline-block;
    }

    #gaming ul li span {
      background: var(--uni-green);
      color: #fff;
      padding: 6px 12px;
      border-radius: 6px;
      font-size: 14px;
      cursor: pointer;
      transition: background 0.3s ease;
      display: inline-block;
    }

    #gaming ul li span:hover {
      background: var(--uni-green-2);
    }

    /* Responsive tweaks */
    @media (max-width: 600px) {
      #gaming .grid {
        grid-template-columns: 1fr;
      }
    }
  </style>

  <section class="grid">
    
    <!-- eFootball -->
    <article class="card" style="text-align:center;">
      <img src="https://vtpsruejncfykiazrfsx.supabase.co/storage/v1/object/public/PRODUCTS/E-football%20logo" 
           alt="eFootball Logo" style="max-width:120px; margin-bottom:10px;">
      <h3>eFootball</h3>
      <p>Share your Konami ID / Username to connect with fellow players.</p>
      <form onsubmit="addGamertag(event, 'efootball')" style="display:flex;gap:10px;flex-wrap:wrap;">
        <input type="text" id="efootballInput" placeholder="Enter your username" required />
        <button type="submit">Share</button>
      </form>
      <ul id="efootballList"></ul>
    </article>

    <!-- Free Fire -->
    <article class="card" style="text-align:center;">
      <img src="https://vtpsruejncfykiazrfsx.supabase.co/storage/v1/object/public/PRODUCTS/Free%20fire%20logo" 
           alt="Free Fire Logo" style="max-width:120px; margin-bottom:10px;">
      <h3>Free Fire</h3>
      <p>Drop your Free Fire ID or nickname.</p>
      <form onsubmit="addGamertag(event, 'freefire')" style="display:flex;gap:10px;flex-wrap:wrap;">
        <input type="text" id="freefireInput" placeholder="Enter your Free Fire ID" required />
        <button type="submit">Share</button>
      </form>
      <ul id="freefireList"></ul>
    </article>

    <!-- CODM -->
    <article class="card" style="text-align:center;">
      <img src="https://vtpsruejncfykiazrfsx.supabase.co/storage/v1/object/public/PRODUCTS/cod%20logo" 
           alt="COD Mobile Logo" style="max-width:120px; margin-bottom:10px;">
      <h3>Call of Duty Mobile</h3>
      <p>Share your Call of Duty Mobile username to team up.</p>
      <form onsubmit="addGamertag(event, 'codm')" style="display:flex;gap:10px;flex-wrap:wrap;">
        <input type="text" id="codmInput" placeholder="Enter your CODM username" required />
        <button type="submit">Share</button>
      </form>
      <ul id="codmList"></ul>
    </article>

<!-- DLS -->
    <article class="card" style="text-align:center;">
      <img src="https://vtpsruejncfykiazrfsx.supabase.co/storage/v1/object/public/PRODUCTS/DLS%20LOGO" 
           alt="Dream League Soccer Logo" style="max-width:120px; margin-bottom:10px;">
      <h3>Dream League Soccer</h3>
      <p>Share your DLS username to connect with friends.</p>
      <form onsubmit="addGamertag(event, 'dls')" style="display:flex;gap:10px;flex-wrap:wrap;">
        <input type="text" id="dlsInput" placeholder="Enter your DLS username" required />
        <button type="submit">Share</button>
      </form>
      <ul id="dlsList"></ul>
    </article>
    
    
  <!-- BLOOD STRIKE -->
<article class="card" style="text-align:center;">
  <img src="https://vtpsruejncfykiazrfsx.supabase.co/storage/v1/object/public/PRODUCTS/Blood%20strike%20.jpeg" 
       alt="blood strike Logo" style="max-width:120px; margin-bottom:10px;">
  <h3>BLOOD STRIKE</h3>
  <p>Share your Blood Strike username to connect with friends.</p>
  <form onsubmit="addGamertag(event, 'blood strike')" style="display:flex;gap:10px;flex-wrap:wrap;">
    <input type="text" id="bloodstrikeInput" placeholder="Enter your Blood Strike username" required />
    <button type="submit">Share</button>
  </form>
  <ul id="bloodstrikeList"></ul>
</article>


  </section>
</section>


<!-- ANONYMOUS MESSAGES SECTION -->
<section id="anonymous" class="page-section" style="display:none;">

  <h2>üí¨ Anonymous Messages</h2>

  <!-- FORM -->
  <form onsubmit="submitAnonymousMessage(event)" class="anon-form">
    <textarea id="anonText" placeholder="Type your anonymous message..." required></textarea>
    <input type="file" id="anonFile" accept="image/*,.pdf,.doc,.docx" />

    <!-- PREVIEW AREA -->
    <div id="anonPreview" class="anon-preview"></div>

    <button type="button" onclick="previewAnonymousMessage()">üëÄ Preview</button>
    <button type="submit">üöÄ Post Message</button>
  </form>

  <!-- MESSAGES FEED -->
  <h3>üì∞ Recent Messages</h3>
  <div id="anonMessages" class="anon-messages"></div>
  <button id="loadMoreBtn" onclick="loadMoreAnonymousMessages()" style="display:none;">‚¨áÔ∏è Load More</button>
</section>


<!-- ============================
   ANONYMOUS MESSAGES STYLING
============================ -->
<style>
#anonymous {
  padding: 20px;
  background: #f9fdf9; /* light background */
  min-height: 100vh;
}

/* Section title */
#anonymous h2, 
#anonymous h3 {
  color: #0a5a2b; /* Uni green */
  text-align: center;
  margin-bottom: 15px;
  font-weight: bold;
}

/* Form container */
#anonymous form {
  background: #ffffff;
  padding: 16px;
  border-radius: 10px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.1);
  margin-bottom: 20px;
}

/* Textarea */
#anonymous textarea {
  width: 100%;
  padding: 12px;
  border: 1px solid #cfd8cf;
  border-radius: 8px;
  resize: none;
  min-height: 80px;
  font-size: 15px;
  outline: none;
}

/* File input */
#anonymous input[type="file"] {
  margin-top: 10px;
  display: block;
  font-size: 14px;
}

/* Buttons */
#anonymous button {
  background: #0a5a2b;
  color: #fff;
  border: none;
  padding: 10px 18px;
  border-radius: 6px;
  margin-top: 12px;
  cursor: pointer;
  font-size: 15px;
  transition: background 0.3s ease;
}

#anonymous button:hover {
  background: #155e36;
}

#anonymous button[type="button"] {
  background: #ffffff;
  color: #0a5a2b;
  border: 1px solid #0a5a2b;
  margin-right: 8px;
}

#anonymous button[type="button"]:hover {
  background: #e9f7ee;
}

/* Messages list */
#anonMessages {
  display: flex;
  flex-direction: column;
  gap: 15px;
}

/* Each message card */
.anon-card {
  background: #fff;
  padding: 14px;
  border-radius: 10px;
  border-left: 4px solid #0a5a2b;
  box-shadow: 0 1px 4px rgba(0,0,0,0.08);
  font-size: 15px;
  line-height: 1.5;
  word-wrap: break-word;
}

.anon-card p {
  margin: 0;
  color: #111;
}

/* Image inside messages */
.anon-card img {
  margin-top: 10px;
  border-radius: 6px;
  max-width: 100%;
  height: auto;
}

/* File link */
.anon-card a {
  display: inline-block;
  margin-top: 10px;
  color: #0a5a2b;
  text-decoration: none;
  font-weight: bold;
}

.anon-card a:hover {
  text-decoration: underline;
}

/* Responsive */
@media (max-width: 600px) {
  #anonymous h2 {
    font-size: 1.4rem;
  }
  #anonymous textarea {
    min-height: 70px;
  }
}
</style>

<!-- UNIOSUN LOGIN HELP -->
<section id="uniosun-login-help" class="page-section" style="display:none;">
  <h2 class="section">UNIOSUN Login Help</h2>

  <!-- Copy Portal Link -->
  <button onclick="copyPortalLink()" style="
    background:#0a5a2b; color:white; border:none; border-radius:4px;
    padding:8px 12px; cursor:pointer; margin-bottom:15px;
  ">Copy UNIOSUN Portal Link</button>

  <section class="grid">

    <!-- Step 1: Open Portal -->
    <article class="card">
      <h3>Step 1: Open UNIOSUN Portal</h3>
      <img src="https://vtpsruejncfykiazrfsx.supabase.co/storage/v1/object/public/PRODUCTS/1.jpeg" 
           alt="UNIOSUN Portal Homepage" 
           style="width:100%; border-radius:8px; margin-top:10px;" />
      <p>Go to the official UNIOSUN portal to start the login or password retrieval process,click on returning applicants</p>
      <div class="hr"></div>
    </article>

    <!-- Step 2: Click Forgot Password -->
    <article class="card">
      <h3>Step 2: Click 'Login or Forgot Password'</h3>
      <img src="https://vtpsruejncfykiazrfsx.supabase.co/storage/v1/object/public/PRODUCTS/2.jpeg" 
           alt="LOGIN" 
           style="width:100%; border-radius:8px; margin-top:10px;" />
      <p>On the login page, input your details or <b>'forgot password'</b>if you dont remember it</p>
      <div class="hr"></div>
    </article>

    <!-- Step 3: Enter Email or Matric Number -->
    <article class="card">
      <h3>Step 3: Enter JAMB REG and Email</h3>
      <img src="https://vtpsruejncfykiazrfsx.supabase.co/storage/v1/object/public/PRODUCTS/3.jpeg" 
           alt="Email Entry Screen" 
           style="width:100%; border-radius:8px; margin-top:10px;" />
      <p>Provide your registered email and jamb registration number to receive the password reset link.</p>
      <div class="hr"></div>
    </article>

    <!-- Step 4: Check Email & Reset Password -->
    <article class="card">
      <h3>Step 4: Check Email & Reset Password</h3>
      <img src="https://vtpsruejncfykiazrfsx.supabase.co/storage/v1/object/public/PRODUCTS/4.jpeg" 
           alt="Password Reset Email" 
           style="width:100%; border-radius:8px; margin-top:10px;" />
      <p>Check your inbox (and spam folder) for the password reset link sent by UNIOSUN. Follow the link to set a new password.</p>
      <div class="hr"></div>
    </article>

    <!-- Step 5: Log In With New Password -->
    <article class="card">
      <h3>Step 5: Log In</h3>
      <img src="https://vtpsruejncfykiazrfsx.supabase.co/storage/v1/object/public/PRODUCTS/2.jpeg"" 
           alt="Login Successful" 
           style="width:100%; border-radius:8px; margin-top:10px;" />
      <p>Return to the portal login page and log in with your new password to access your account.</p>
      <div class="hr"></div>
    </article>

  </section>
</section>

<!-- üìë PDF RESOURCES SECTION -->
<section id="pdfs" class="page-section" style="padding:20px;">
  <h2 class="section">üìë PDF Resources</h2>
  <p>Download past questions, guides, and handouts.</p>

  <!-- Level Selection -->
  <label for="levelSelect"><b>Choose your level:</b></label>
  <select id="levelSelect" class="styled-select">
    <option value="">-- All Levels --</option>
    <option value="100L">100 Level</option>
    <option value="200L">200 Level</option>
    <option value="300L">300 Level</option>
    <option value="400L">400 Level</option>
  </select>

  <!-- PDF Container -->
  <div id="pdfSection" style="margin-top:20px;"></div>
</section>


<style>
/* ============================
   PDF CARDS ‚Äì CLEAN, POLISHED
============================ */

/* Container for PDF cards per level */
.pdf-grid {
  display: flex;
  flex-wrap: wrap;
  gap: 18px;
  margin-top: 20px;
  justify-content: flex-start;
}

/* Individual PDF card */
.pdf-card {
  background: #ffffff;
  border-radius: 12px;
  padding: 16px;
  box-shadow: 0 3px 10px rgba(0,0,0,0.08);
  width: 300px;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  transition: all 0.3s ease;
  min-height: 140px; /* ensures even card height */
}

.pdf-card:hover {
  transform: translateY(-4px);
  box-shadow: 0 6px 16px rgba(0,0,0,0.15);
}

/* PDF card content: logo + info */
.pdf-card-content {
  display: flex;
  align-items: flex-start;
  gap: 12px;
  width: 100%;
}

/* Logo beside each PDF */
.pdf-logo {
  width: 50px;
  height: 50px;
  object-fit: contain;
  border-radius: 6px;
}

/* PDF info (title + buttons) */
.pdf-info {
  flex: 1;
  display: flex;
  flex-direction: column;
  justify-content: center;
}

/* PDF Title */
.pdf-card h4 {
  font-size: 15px;
  margin-bottom: 8px;
  color: #111;
  font-weight: 700;
  line-height: 1.4;
  word-break: break-word;
}

/* Buttons container */
.pdf-actions {
  display: flex;
  align-items: center;
  flex-wrap: wrap;
  gap: 8px;
  margin-top: 6px;
}

/* Download / Copy / View / Share buttons */
.pdf-btn {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 6px 12px;
  background: #0a5a2b;
  color: #fff;
  border: none;
  border-radius: 6px;
  font-weight: 600;
  font-size: 13px;
  cursor: pointer;
  text-decoration: none;
  transition: all 0.2s ease;
}

.pdf-btn i {
  font-size: 14px;
}

.pdf-btn:hover {
  background: #0f7b3d;
  transform: translateY(-1px);
  box-shadow: 0 2px 6px rgba(0,0,0,0.2);
}

/* Dropdown Styling */
.styled-select {
  padding: 10px 14px;
  border: 2px solid #0a5a2b;
  border-radius: 8px;
  font-size: 14px;
  font-weight: 600;
  background: #f7fff7;
  color: #0a5a2b;
  outline: none;
  cursor: pointer;
  margin-top: 10px;
  transition: 0.3s;
  width: 100%;
  max-width: 300px;
}

.styled-select:hover {
  background: #eafaea;
}

/* ============================
   Responsive Adjustments
============================ */
@media (max-width: 768px) {
  .pdf-card {
    width: 100%;
    min-height: auto;
  }
  .pdf-card-content {
    flex-direction: row;
    align-items: center;
  }
  .pdf-actions {
    justify-content: flex-start;
  }
}
</style>

  <!-- Marketplace -->
<section id="marketplace" class="page-section">
  <h2 class="section">üõçÔ∏è UNIOSUN MARKETPLACE</h2>
  <p>
    Shop campus essentials, merch & e-books right here on <b>Eyes of 3080</b>.
  </p>
  <p>
    Want to sell your products on our marketplace?  
  </p>
  <a href="https://wa.me/2347063123719?text=Hello%2C%20I%20want%20to%20register%20my%20goods%20on%20UNIOSUN%20Marketplace" 
     target="_blank" 
     style="display:inline-block; background:#0a5a2b; color:#fff; padding:12px 24px; border-radius:30px; font-weight:600; text-decoration:none; transition:background 0.3s ease;">
    üì© Register
  </a>
</section>

  <!-- PRODUCT GRID (dynamic from Supabase) -->
  <div class="product-grid">
    <!-- Products will load here automatically -->
  </div>
</section>

<!-- üõí CART DRAWER -->
<div id="cart-drawer">
  <h3>Your Cart</h3>
  <div id="cart-items"></div>
  <p class="total">Total: ‚Ç¶<span id="cart-total">0</span></p>
  <button class="checkout" onclick="checkoutWhatsApp()">‚úÖ Checkout via WhatsApp</button>
  <button class="close-cart" onclick="toggleCart()">‚úñ Close</button>
</div>

<!-- üõí CART ICON -->
<div id="cart-icon" class="cart-icon" onclick="toggleCart()">
  üõí <span id="cart-count">0</span>
</div>

<style>
/* ===================== MARKETPLACE LAYOUT ===================== */
#marketplace {
  margin-top: 40px;
  padding: 20px;
}

.product-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(230px, 1fr));
  gap: 20px;
}

.product-card {
  background: #fff;
  border-radius: 12px;
  padding: 15px;
  text-align: center;
  box-shadow: 0 4px 10px rgba(0,0,0,0.1);
  transition: transform 0.2s, box-shadow 0.2s;
}

.product-card:hover { 
  transform: translateY(-6px); 
  box-shadow: 0 6px 15px rgba(0,0,0,0.15);
}

.product-card img {
  max-width: 100%;
  border-radius: 8px;
  margin-bottom: 10px;
}

.product-card h3 { 
  margin: 8px 0; 
  font-size: 18px; 
}

.price { 
  font-weight: bold; 
  color: #0a5a2b; 
  font-size: 16px; 
}

.desc { 
  font-size: 13px; 
  color: #666; 
}

.product-card button {
  margin-top: 10px;
  background: #0a5a2b;
  color: white;
  border: none;
  padding: 10px 14px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 14px;
  transition: background 0.3s;
}

.product-card button:hover { 
  background: #155e36; 
}

/* ===================== CART DRAWER ===================== */
#cart-drawer {
  position: fixed;
  top: 0; 
  right: -350px;
  width: 320px;
  height: 100%;
  background: #fff;
  box-shadow: -3px 0 10px rgba(0,0,0,0.3);
  padding: 20px;
  transition: right 0.3s ease;
  z-index: 1000;
  display: flex;
  flex-direction: column;
}

#cart-drawer.open { 
  right: 0; 
}

#cart-items { 
  flex: 1; 
  overflow-y: auto; 
  margin: 10px 0; 
}

.cart-item { 
  display: flex; 
  align-items: center; 
  justify-content: space-between; 
  margin-bottom: 12px; 
}

.cart-item img { 
  width: 45px; 
  height: 45px; 
  margin-right: 10px; 
  border-radius: 5px; 
}

.cart-item span { 
  flex: 1; 
  font-size: 14px; 
}

.cart-item .qty { 
  display: flex; 
  align-items: center; 
}

.cart-item button { 
  background: #ddd; 
  border: none; 
  padding: 4px 8px; 
  margin: 0 3px; 
  cursor: pointer; 
  border-radius: 4px; 
}

.cart-item button:hover { 
  background: #bbb; 
}

.total { 
  font-weight: bold; 
  margin-top: 10px; 
  font-size: 16px; 
}

.checkout, .close-cart {
  margin-top: 12px;
  padding: 12px;
  border: none;
  background: #0a5a2b;
  color: #fff;
  border-radius: 6px;
  cursor: pointer;
  font-size: 15px;
}

.checkout:hover { 
  background: #155e36; 
}

.close-cart { 
  background: #888; 
}

.close-cart:hover { 
  background: #555; 
}

/* ===================== FLOATING CART ICON ===================== */
.cart-icon {
  position: fixed;
  top: 15px; 
  right: 20px;
  background: #0a5a2b;
  color: #fff;
  padding: 8px 12px;
  border-radius: 25px;
  cursor: pointer;
  font-size: 16px;
  z-index: 1100;
  display: none; /* hidden by default */
}

.cart-icon span {
  background: red;
  color: #fff;
  font-size: 12px;
  padding: 2px 6px;
  border-radius: 50%;
  margin-left: 5px;
}
</style>

  <!-- SINGLE POST -->
<section id="postDetail" class="page-section" style="display:none; padding:20px;">
  
  <!-- Headlines Header -->
  <h2 class="headline-title" onclick="goBack()" style="cursor:pointer;">
      NEWS
  </h2>
  
  <!-- Back Button -->
  <div class="back-btn" onclick="goBack()" style="margin:10px 0; cursor:pointer;">‚Üê</div>
  
  <!-- Post Title -->
  <h1 id="detailTitle"></h1>
  <p id="detailMeta"></p>
  
  <!-- Post Image -->
  <img id="detailImage" style="display:none; max-width:100%; border-radius:8px; margin:10px 0;" />
  
  <!-- Post Content -->
  <div id="detailContent"></div>

  <!-- Share Section -->
  <div class="share-section" style="margin-top:20px;">
    <span>Share:</span>
    <div class="share-icons">
      <a href="#" onclick="sharePost('whatsapp')"><i class="fab fa-whatsapp" style="color:#25D366;"></i></a>
      <a href="#" onclick="sharePost('twitter')"><i class="fab fa-twitter" style="color:#1DA1F2;"></i></a>
      <a href="#" onclick="sharePost('facebook')"><i class="fab fa-facebook" style="color:#1877F2;"></i></a>
      <a href="#" onclick="sharePost('copy')"><i class="fas fa-link" style="color:#555;"></i></a>
    </div>
  </div>
</section>
<!-- COUNTER SECTION -->
<section class="stats-section">
  <div class="stats-container">
    <div class="stat-box">
      <h2 class="counter" data-target="900">0</h2>
      <p>TOTAL USERS</p>
    </div>
    <div class="stat-box">
      <h2 class="counter" data-target="800">0</h2>
      <p>ACTIVE USERS</p>
    </div>
    <div class="stat-box">
      <h2 class="counter" data-target="900">0</h2>
      <p>ONLINE USERS</p>
    </div>
    <div class="stat-box">
      <h2 class="counter" data-target="2">0+</h2>
      <p>YEARS OF EXPERIENCE</p>
    </div>
  </div>
</section>

<!-- FOOTER -->
<footer style="background:var(--uni-green); color:#fff; padding:30px 16px; margin-top:0;">
  <div style="max-width:1100px; margin:0 auto; display:flex; flex-wrap:wrap; justify-content:space-between; gap:20px;">
    
    <!-- Left: About -->
    <div style="flex:1; min-width:220px;">
      <h3 style="margin-top:0;">EYES OF 3080</h3>
      <p style="margin:0;">Your trusted source for campus news, academic updates, and student life at Osun State University.</p>
    </div>
    
    <!-- Middle: Quick Links -->
    <div style="flex:1; min-width:180px;">
      <h3 style="margin-top:0;">Quick Links</h3>
      <ul style="list-style:none; padding:0; margin:0; line-height:1.8;">
        <li><a href="#" onclick="showSection('home')" style="color:#fff; text-decoration:none;">Home</a></li>
        <li><a href="#" onclick="showSection('gaming')" style="color:#fff; text-decoration:none;">Gaming Zone</a></li>
        <li><a href="#" onclick="showSection('contact')" style="color:#fff; text-decoration:none;">Contact</a></li>
        <li><a href="#" onclick="showSection('about-us')" style="color:#fff; text-decoration:none;">About Us</a></li>
      </ul>
    </div>
    
    <!-- Right: Contact -->
    <div style="flex:1; min-width:220px;">
      <h3 style="margin-top:0;">Contact</h3>
      <p>Email: <a href="mailto:eyesof3080@gmail.com" style="color:#fff;">eyesof3080@gmail.com</a></p>
      <p>WhatsApp: <a href="https://wa.me/2349043855915?text=Hello%20I%20want%20to%20promote%20my%20business%20on%20your%20website" target="_blank" style="color:#fff;">+2349043855915</a></p>
    </div>
  </div>
  
  <!-- About Us Section -->
  <div id="about-us" style="max-width:900px; margin:30px auto 0; text-align:center;">
    <h3>About Us</h3>
    <p style="line-height:1.6;">
      EYES OF 3080, We keep students connected, share real updates, and inspire one another to grow in UNIOSUN.
    </p>
  </div>

  <hr style="border-color:rgba(255,255,255,0.2); margin:20px 0;">
  
  <!-- Advertisement & Channel Info -->
  <p style="text-align:center; margin:5px 0; font-weight:bold;">
    Ads & Promotions: Contact us on WhatsApp 
    <a href="https://wa.me/2348162833687?text=Hello%20I%20want%20to%20advertise%20on%20EYES%20OF%203080" target="_blank" style="color:#fff; text-decoration:underline;">+2348162833687</a>
  </p>

  <p style="text-align:center; margin:5px 0; font-weight:bold;">
    Join Our WhatsApp Channel: 
    <a href="https://whatsapp.com/channel/0029Vb5GgTd7YSd37MohjE34" target="_blank" style="color:#fff; text-decoration:underline;">Click Here</a>
  </p>
</footer>

<!-- Counter Styles -->
<style>
  .stats-section {
    background: var(--uni-green);
    color: #fff;
    padding: 50px 20px;
    text-align: center;
  }
  .stats-container {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    max-width: 1000px;
    margin: auto;
    gap: 30px;
  }
  .stat-box {
    flex: 1;
    min-width: 200px;
  }
  .stat-box h2 {
    font-size: 2.5rem;
    margin: 0;
    font-weight: bold;
  }
  .stat-box p {
    margin: 10px 0 0;
    font-size: 1.1rem;
  }
</style>

<script src="https://unpkg.com/@supabase/supabase-js"></script>
<script>
/* ============================
   SUPABASE CONFIG
============================ */
const SUPABASE_URL = "https://vtpsruejncfykiazrfsx.supabase.co";
const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZ0cHNydWVqbmNmeWtpYXpyZnN4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY3NDA5NzQsImV4cCI6MjA3MjMxNjk3NH0.UV55gbsSAgnyolxJhIYTaJUpvoJFsJn0_-LMNwhwAK0";
const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

/* ============================
   COUNTER
============================ */
const counters = document.querySelectorAll('.counter');
const speed = 200;
counters.forEach(counter => {
  const animate = () => {
    const value = +counter.getAttribute('data-target');
    const current = +counter.innerText.replace('+','');
    const increment = Math.ceil(value / speed);
    if (current < value) {
      counter.innerText = current + increment;
      setTimeout(animate, 30);
    } else {
      counter.innerText = value + (counter.innerText.includes('+') ? '+' : '');
    }
  };
  animate();
});

/* ============================
   MENU + DARK MODE
============================ */
function toggleMenu(){ document.getElementById("menu").classList.toggle("active"); }
function toggleDarkMode(){ document.body.classList.toggle("dark"); }
document.querySelectorAll("#menu a").forEach(link=>{
  link.addEventListener("click", ()=>{ document.getElementById("menu").classList.remove("active"); });
});

/* ============================
   SECTION SWITCHING
============================ */
function showSection(id){
  document.querySelectorAll(".page-section").forEach(sec => sec.style.display="none");
  document.getElementById("postDetail").style.display="none";
  const section = document.getElementById(id);
  if(section) section.style.display="block";
  window.scrollTo(0,0);
}


// ‚úÖ Toggle Chatbox
  function toggleChat() {
    const chatbox = document.getElementById("chatbot");
    const toggleBtn = document.getElementById("chat-toggle");
    if (chatbox.style.display === "none") {
      chatbox.style.display = "flex";
      toggleBtn.style.display = "none";
      greetBot();
    } else {
      chatbox.style.display = "none";
      toggleBtn.style.display = "flex";
    }
  }

  // ‚úÖ Auto greeting when opened
  function greetBot() {
    const messages = document.getElementById("chat-messages");
    if (messages.innerHTML.trim() === "") {
      messages.innerHTML += `<div class="msg bot">üëã Hi! I‚Äôm the <b>Eyes of 3080 Assistant</b>. Ask me about GPA, Aggregate, Cut-off, Screening, or News!</div>`;
    }
  }

  function handleChat(e) {
    if (e.key === "Enter") {
      sendChat();
    }
  }

  function sendChat() {
    const input = document.getElementById("chat-input");
    const messages = document.getElementById("chat-messages");
    const userMsg = input.value.trim();
    if (!userMsg) return;

    // User msg
    messages.innerHTML += `<div class="msg user">${userMsg}</div>`;
    input.value = "";

    // Bot reply
    let reply = "ü§î I don‚Äôt know that yet. Try asking about GPA, Aggregate, Cut-off, Screening, or News.";

    if (/cut.?off/i.test(userMsg)) {
      reply = "üìä UNIOSUN cut-off marks vary by course. Nursing and Medicine usually have higher cut-offs.";
    } 
    else if (/gpa/i.test(userMsg)) {
      reply = "üéì GPA = Total Grade Points √∑ Total Credit Units. Try our GPA Calculator!";
    } 
    else if (/aggregate/i.test(userMsg)) {
      reply = "üìå Aggregate = JAMB% + O‚ÄôLevel%. Use the Aggregate Calculator section.";
    } 
    else if (/screening/i.test(userMsg)) {
      reply = "üìù Screening updates are posted on the school portal and Eyes of 3080.";
    } 
    else if (/hello|hi/i.test(userMsg)) {
      reply = "üëã Hello! How can I help you today?";
    }

    messages.innerHTML += `<div class="msg bot">${reply}</div>`;
    messages.scrollTop = messages.scrollHeight;
  }
 /* ============================
   RENDER POSTS + FULL POST WITH COMMENTS
============================ */

// Ensure post-modal container exists
if (!document.getElementById("post-modal")) {
  const modalContainer = document.createElement("div");
  modalContainer.id = "post-modal";
  modalContainer.style.position = "fixed";
  modalContainer.style.top = "0";
  modalContainer.style.left = "0";
  modalContainer.style.width = "100%";
  modalContainer.style.height = "100%";
  modalContainer.style.overflow = "auto";
  modalContainer.style.background = "rgba(0,0,0,0.5)";
  modalContainer.style.display = "none"; // hidden initially
  modalContainer.style.padding = "50px";
  modalContainer.style.zIndex = "9999";

  document.body.appendChild(modalContainer);
}

// Render post cards (main list) with logo
function renderCard(post, table) {
  const logoUrl = "https://vtpsruejncfykiazrfsx.supabase.co/storage/v1/object/public/PRODUCTS/EYES%20OF%203080%20logo";

  return `
    <article class="card" style="border:1px solid #006400; padding:15px; margin-bottom:15px; border-radius:8px; display:flex; align-items:flex-start; gap:10px;">
      <img src="${logoUrl}" alt="Logo" style="width:50px; height:50px; border-radius:50%; flex-shrink:0;">
      <div style="flex:1;">
        <div class="card-header" style="display:flex; align-items:center; justify-content:space-between;">
          <h3 style="flex:1; margin:0; padding-right:10px; color:#006400;">${post.title}</h3>
          <div class="card-actions" style="display:flex; gap:8px; align-items:center;">
            <img src="https://cdn-icons-png.flaticon.com/512/3466/3466003.png" 
                 alt="Share" style="width:20px; cursor:pointer;" 
                 onclick="openShareMenu('${post.id}', '${table}')">
          </div>
        </div>

        <p>${post.excerpt || (post.content ? post.content.substring(0, 100) : "")}...</p>
        <button class="btn" 
                style="background:#006400; color:white; padding:6px 12px; border:none; border-radius:4px;" 
                onclick="openPost('${post.id}', '${table}')">
          Read More
        </button>
      </div>
    </article>
  `;
}

// Open full post with comment section
async function openPost(id, table = "home") {
  try {
    const { data: post, error } = await supabase
      .from(table)
      .select("*")
      .eq("id", id)
      .single();

    if (error || !post) {
      alert("‚ùå Could not load post.");
      return;
    }

    const container = document.getElementById("post-modal"); 

    // Show modal
    container.style.display = "block";

    container.innerHTML = `
      <div style="background:white; border-radius:8px; max-width:800px; margin:0 auto; padding:20px; position:relative;">
        <button onclick="closePostModal()" 
                style="position:absolute; top:10px; right:10px; background:#006400; color:white; border:none; padding:5px 10px; border-radius:4px; cursor:pointer;">
          Close
        </button>
        <h1 style="color:#006400;">${post.title}</h1>
        <p style="margin-bottom:10px;">${post.content}</p>

        <!-- COMMENTS -->
        <div id="comments-section-${post.id}" style="margin-top:20px; border-top:1px solid #006400; padding-top:10px;">
          <h4 style="color:#006400;">Comments</h4>
          <div id="comments-container-${post.id}"></div>

          <textarea id="comment-input-${post.id}" 
                    placeholder="Write a comment..." 
                    style="width:100%; padding:8px; margin-top:5px; border:1px solid #006400; border-radius:5px;"></textarea>

          <button style="background:#006400; color:white; padding:6px 12px; border:none; border-radius:4px; margin-top:5px;" 
                  onclick="submitComment('${post.id}')">
            Submit
          </button>
        </div>
      </div>
    `;

    loadComments(post.id);

  } catch (err) {
    console.error(err);
    alert("Something went wrong.");
  }
}

// Close modal
function closePostModal() {
  const container = document.getElementById("post-modal");
  container.style.display = "none";
  container.innerHTML = ""; // clear content
}

// Load comments for a specific post
async function loadComments(postId) {
  const { data: comments, error } = await supabase
    .from("comments")
    .select("*")
    .eq("post_id", postId)
    .order("created_at", { ascending: true });

  if (error) {
    console.error(error);
    return;
  }

  const container = document.getElementById(`comments-container-${postId}`);
  container.innerHTML = comments.map(c => `
    <div style="margin-bottom:8px; padding:6px; border-bottom:1px solid #ccc;">
      <b style="color:#006400;">${c.username}</b> 
      <span style="font-size:11px; color:#555;">(${new Date(c.created_at).toLocaleString()})</span>
      <p style="margin:4px 0;">${c.content}</p>
    </div>
  `).join("");
}

// Submit a comment
async function submitComment(postId) {
  const input = document.getElementById(`comment-input-${postId}`);
  const content = input.value.trim();
  if (!content) return alert("Comment cannot be empty");

  const user = supabase.auth.user();
  if (!user) return alert("You must be logged in to comment");

  const { error } = await supabase
    .from("comments")
    .insert([
      { post_id: postId, username: user.email, content }
    ]);

  if (error) {
    console.error(error);
    return alert("Failed to submit comment");
  }

  input.value = "";
  loadComments(postId); // reload comments
}

/* ============================
   LOAD POSTS INTO GRID
============================ */
async function loadAcademicUpdates() {
  const container = document.getElementById("academic-updates-list");
  if (!container) return;

  const { data, error } = await supabase
    .from("academic")
    .select("*")
    .order("id", { ascending: false });

  if (error) {
    console.error("‚ùå Error fetching academic updates:", error.message);
    return;
  }

  container.innerHTML = data.map(update => renderCard(update, "academic")).join("");
}

async function loadCampusGist() {
  const container = document.getElementById("campus-list");
  if (!container) return;

  const { data, error } = await supabase
    .from("campus")
    .select("*")
    .order("id", { ascending: false });

  if (error) {
    console.error("‚ùå Error fetching campus gist:", error.message);
    return;
  }

  container.innerHTML = data.map(gist => renderCard(gist, "campus")).join("");
}

async function loadHomeNews() {
  const container = document.getElementById("newsGrid");
  if (!container) return;

  const { data, error } = await supabase
    .from("home")
    .select("*")
    .order("id", { ascending: false });

  if (error) {
    console.error("‚ùå Error fetching home news:", error.message);
    return;
  }

  container.innerHTML = data.map(news => renderCard(news, "home")).join("");
}

// ============================
// PDF LOADING & FILTERING
// ============================

// Elements
const pdfSection = document.getElementById("pdfSection");
const levelSelect = document.getElementById("levelSelect");

// ============================
// NORMALIZE LEVEL FUNCTION
// ============================
function normalizeLevel(level) {
  if (!level) return "";
  level = level.toString().toUpperCase().trim();
  if (level === "100L" || level === "100") return "100";
  if (level === "200L" || level === "200") return "200";
  if (level === "300L" || level === "300") return "300";
  if (level === "400L" || level === "400") return "400";
  return "Others";
}

// ============================
// GET FILE NAME FROM URL
// ============================
function getFileNameFromUrl(url) {
  if (!url) return "";
  return decodeURIComponent(url.split("/").pop()); 
}

// ============================
// COPY LINK FUNCTION
// ============================
function copyPDFLink(url) {
  if (!url) return;
  navigator.clipboard.writeText(url)
    .then(() => {
      alert("‚úÖ PDF link copied to clipboard!");
    })
    .catch(() => {
      alert("‚ùå Failed to copy PDF link.");
    });
}

// ============================
// LOAD PDFs FROM SUPABASE
// ============================
async function loadPDFs() {
  try {
    const { data: pdfs, error } = await supabase
      .from("pdf")
      .select("*")
      .order("id", { ascending: false }); // latest first

    if (error) throw error;

    if (!pdfs || pdfs.length === 0) {
      pdfSection.innerHTML = "<p>No PDFs uploaded yet.</p>";
      return;
    }

    // Group PDFs by normalized level
    const levels = {};
    pdfs.forEach(pdf => {
      const lvl = normalizeLevel(pdf.level);
      if (!levels[lvl]) levels[lvl] = [];
      levels[lvl].push(pdf);
    });

    // Render PDFs grouped by level (hidden by default)
    pdfSection.innerHTML = Object.keys(levels)
      .map(lvl => `
        <div class="pdf-grid" id="pdfGrid${lvl}" style="display:none; gap: 16px; margin-bottom: 30px;">
          ${levels[lvl].map(pdf => `
            <div class="pdf-card" style="
              background: linear-gradient(90deg, #004d25, #009e60);
              color: white;
              padding: 16px;
              border-radius: 12px;
              display: flex;
              align-items: center;
              gap: 14px;
              box-shadow: 0 4px 10px rgba(0,0,0,0.15);
              font-family: 'Poppins', sans-serif;
              transition: transform 0.3s;
            ">
              <img src="https://vtpsruejncfykiazrfsx.supabase.co/storage/v1/object/public/PRODUCTS/EYES%20OF%203080%20logo" 
                   alt="Logo" 
                   style="width: 60px; height: 60px; border-radius: 8px; background: white; padding: 4px;">
              
              <div class="pdf-info" style="flex:1;">
                <h4 style="margin: 0 0 6px 0; font-size: 1rem; font-weight: 600;">üìò ${pdf.topic || getFileNameFromUrl(pdf.pdf_url) || "Untitled PDF"}</h4>
                <p style="margin: 0 0 8px 0; font-size: 0.85rem; opacity: 0.9;">Level: ${pdf.level || "N/A"}</p>
                
                <div class="pdf-actions" style="display:flex; gap:8px; flex-wrap:wrap;">
                  <a href="${pdf.pdf_url}" target="_blank" class="pdf-btn" style="
                    background: rgba(255,255,255,0.15);
                    color: white;
                    border: none;
                    padding: 8px 12px;
                    border-radius: 6px;
                    text-decoration: none;
                    display: flex;
                    align-items: center;
                    gap: 6px;
                    font-size: 0.85rem;
                    transition: background 0.3s;
                  ">
                    <i class="bi bi-eye-fill"></i> View
                  </a>

                  <a href="${pdf.pdf_url}" download class="pdf-btn" style="
                    background: rgba(255,255,255,0.15);
                    color: white;
                    border: none;
                    padding: 8px 12px;
                    border-radius: 6px;
                    text-decoration: none;
                    display: flex;
                    align-items: center;
                    gap: 6px;
                    font-size: 0.85rem;
                    transition: background 0.3s;
                  ">
                    <i class="bi bi-download"></i> Download
                  </a>

                  <button class="pdf-btn" onclick="copyPDFLink('${pdf.pdf_url}')" style="
                    background: rgba(255,255,255,0.15);
                    color: white;
                    border: none;
                    padding: 8px 12px;
                    border-radius: 6px;
                    cursor: pointer;
                    display: flex;
                    align-items: center;
                    gap: 6px;
                    font-size: 0.85rem;
                    transition: background 0.3s;
                  ">
                    <i class="bi bi-clipboard"></i> Copy Link
                  </button>
                </div>
              </div>
            </div>
          `).join('')}
        </div>
      `)
      .join('');

  } catch (err) {
    console.error("‚ùå Error loading PDFs:", err);
    pdfSection.innerHTML = "<p>Failed to load PDFs.</p>";
  }
}

// ============================
// SHOW PDFs BY LEVEL
// ============================
function showLevelPDFs(selectedLevel = "") {
  const level = normalizeLevel(selectedLevel);
  const grids = document.querySelectorAll(".pdf-grid");
  grids.forEach(grid => grid.style.display = "none"); // hide all

  if (level === "") {
    // If "All Levels" selected, show nothing
    return;
  } else {
    // Show only selected level
    const grid = document.getElementById("pdfGrid" + level);
    if (grid) grid.style.display = "grid";
  }
}

// ============================
// LEVEL SELECT EVENT
// ============================
if (levelSelect) {
  levelSelect.addEventListener("change", function() {
    showLevelPDFs(this.value);
  });
}

// ============================
// INITIAL LOAD
// ============================
loadPDFs();





/* ============================
   OPEN SINGLE POST
============================ */
async function openPost(id, table = "home") {
  try {
    const safeId = isNaN(Number(id)) ? id : Number(id);
    const { data: post, error } = await supabase
      .from(table)
      .select("*")
      .eq("id", safeId)
      .single();

    if (error || !post) {
      console.error("‚ùå Error fetching post:", error?.message, "| ID:", safeId, " Table:", table);
      alert("‚ùå Could not load post. Please try again.");
      return;
    }

    // Hide other sections and show detail
    document.querySelectorAll(".page-section").forEach(sec => sec.style.display = "none");
    document.getElementById("postDetail").style.display = "block";

    // Title + Actions
    const titleContainer = document.getElementById("detailTitle");
    titleContainer.innerHTML = `
      <span class="post-title-text">${post.title}</span>
      <img src="https://cdn-icons-png.flaticon.com/512/3466/3466003.png"
           alt="Share"
           class="title-share-icon"
           style="width:20px;cursor:pointer;margin-left:8px;"
           onclick="openShareMenu('${post.id}', '${table}')">
      <img src="https://cdn-icons-png.flaticon.com/512/60/60577.png"
           alt="Print"
           class="title-print-icon"
           style="width:16px;cursor:pointer;margin-left:6px;"
           onclick="printPost('${post.id}', '${table}')">
    `;

    // Date
    const createdAt = post.created_at ? new Date(post.created_at).toDateString() : "Unknown date";
    document.getElementById("detailMeta").innerText = `üìÖ Posted on ${createdAt}`;

    // Main Image (with watermark overlay)
    if (post.image_url) {
      document.getElementById("detailImage").outerHTML = `
        <div style="position:relative;display:block;max-width:100%;margin:10px 0;">
          <img src="${post.image_url}" style="width:100%;border-radius:6px;">
          <img src="https://vtpsruejncfykiazrfsx.supabase.co/storage/v1/object/public/PRODUCTS/EYES%20OF%203080%20logo" 
               style="position:absolute;bottom:10px;right:10px;width:25%;max-width:200px;opacity:0.9;pointer-events:none;">
        </div>
      `;
    } else {
      document.getElementById("detailImage").style.display = "none";
    }

    // Handle content
    let formattedContent = "";
    if (post.content) {
      formattedContent = post.content
        .split(/\n+/)
        .map(line => {
          line = line.trim();

          // üéß Handle Radio Player
          if (line.includes("mytuner-radio.com")) {
            return `
              <div style="margin-top:15px;text-align:center;">
                <button onclick="document.getElementById('radioPlayer').style.display='block'; this.style.display='none';"
                        style="background:#006400;color:white;padding:10px 20px;border:none;border-radius:5px;cursor:pointer;">
                  üéß Play Live
                </button>
                <div id="radioPlayer" style="display:none;margin-top:15px;">
                  <iframe src="${line}" 
                          width="100%" height="120" 
                          frameborder="0" allow="autoplay">
                  </iframe>
                </div>
              </div>`;
          }

          // üì∫ Handle Facebook Video
          if (line.includes("facebook.com")) {
            return `
              <div class="video-container" style="position:relative;max-width:700px;margin:20px auto;">
                <iframe 
                  src="https://www.facebook.com/plugins/video.php?href=${encodeURIComponent(line)}&show_text=false&width=700"
                  width="100%" 
                  height="400" 
                  style="border:none;overflow:hidden;border-radius:8px;" 
                  scrolling="no" 
                  frameborder="0" 
                  allowfullscreen="true" 
                  allow="autoplay; clipboard-write; encrypted-media; picture-in-picture; web-share">
                </iframe>
                <!-- Watermark logo -->
                <img src="https://vtpsruejncfykiazrfsx.supabase.co/storage/v1/object/public/PRODUCTS/EYES%20OF%203080%20logo" 
                     style="position:absolute;top:10px;right:10px;width:25%;max-width:200px;opacity:0.9;pointer-events:none;">
              </div>`;
          }

          // üñºÔ∏è Handle direct image links (with watermark)
          if (/\.(jpeg|jpg|png|gif)$/i.test(line)) {
            return `
              <div style="position:relative;display:block;max-width:100%;margin:10px 0;">
                <img src="${line}" style="width:100%;border-radius:6px;">
                <img src="https://vtpsruejncfykiazrfsx.supabase.co/storage/v1/object/public/PRODUCTS/EYES%20OF%203080%20logo" 
                     style="position:absolute;bottom:10px;right:10px;width:25%;max-width:200px;opacity:0.9;pointer-events:none;">
              </div>`;
          }

          // üåê Skip raw plain links completely
          if (/^https?:\/\//i.test(line)) {
            return ""; // don‚Äôt show plain links as text
          }

          // Normal text
          return line ? `<p>${line}</p>` : "";
        })
        .join("");
    }

    // Put it in detailContent
    document.getElementById("detailContent").innerHTML = formattedContent;

    // Update browser history
    history.pushState({ postId: safeId, table }, post.title, `?id=${safeId}&t=${table}`);
  } catch (err) {
    console.error("‚ùå Unexpected error opening post:", err);
    alert("Something went wrong while opening this post.");
  }
}



/* ============================
   PRINT POST WITH WATERMARK
============================ */
async function printPost(id, table = "home") {
  try {
    const safeId = isNaN(Number(id)) ? id : Number(id);
    const { data: post, error } = await supabase
      .from(table)
      .select("*")
      .eq("id", safeId)
      .single();

    if (error || !post) {
      console.error("‚ùå Error fetching post for print:", error?.message);
      alert("‚ùå Could not load post for printing.");
      return;
    }

    const newWindow = window.open("", "_blank");

    newWindow.document.write(`
      <html>
        <head>
          <title>${post.title}</title>
          <style>
            body { font-family: Arial, sans-serif; padding:20px; line-height:1.6; color:#222; }

            header { text-align:center; margin-bottom:20px; border-bottom:2px solid #006400; padding-bottom:10px; }
            header img { max-width:80px; display:block; margin:0 auto 8px; }
            h1 { text-align:center; font-size:22px; margin:15px 0; border-top:2px solid #006400; border-bottom:2px solid #006400; padding:10px 0; color:#006400; }
            p.meta { text-align:center; font-size:13px; color:#666; }
            .content { margin-top:20px; position: relative; z-index:1; }
            footer { margin-top:30px; text-align:center; font-size:12px; color:#555; border-top:1px dashed #aaa; padding-top:10px; }

            /* WATERMARK */
           @media print {
  /* Add watermark as background to body */
  body {
    position: relative;
  }

  body::before {
    content: "EYES OF 3080";
    position: fixed; /* stays in same spot on every page */
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%) rotate(-30deg);
    font-size: 36px;
    color: rgba(0, 100, 0, 0.15);
    pointer-events: none;
    text-align: center;
    width: 100%;
    z-index: -1;
    white-space: nowrap;
  }

  /* Make sure content prints correctly */
  header, .content, footer {
    position: relative;
    z-index: 1;
  }

  /* Avoid page breaking inside elements if needed */
  .content p {
    page-break-inside: avoid;
  }
}
          </style>
        </head>
        <body>
          <header>
            <img src="https://vtpsruejncfykiazrfsx.supabase.co/storage/v1/object/public/PRODUCTS/EYES%20OF%203080%20logo" alt="Site Logo" />
            <h2>EYES OF 3080</h2>
          </header>

          <h1>${post.title}</h1>
          <p class="meta">üïí Posted on ${post.created_at ? new Date(post.created_at).toDateString() : "Unknown Date"}</p>

          <div class="content">
            ${post.content ? post.content.split(/\n/).map(line => `<p>${line}</p>`).join('') : ""}
          </div>

          <footer>
            Powered by <b>Eyes of 3080</b> | Printed copy
          </footer>
        </body>
      </html>
    `);

    newWindow.document.close();
    newWindow.focus();
    newWindow.print();
  } catch (err) {
    console.error("‚ùå Unexpected error printing post:", err);
    alert("Something went wrong while printing.");
  }
}
/* ============================
   SHARE
============================ */
function openShareMenu(id, table, title = "EYES OF 3080", preview = "") {
  const url = `${window.location.origin}${window.location.pathname}?id=${id}&t=${table}`;

  if (navigator.share) {
    navigator.share({
      title: title, // dynamic post title
      text: preview || "Read this interesting post:", // short description/preview
      url: url
    }).catch(err => console.log("Share cancelled", err));
  } else {
    const shareOptions = `
      Share this post:\n\n
      üîó WhatsApp: https://wa.me/?text=${encodeURIComponent(title + " - " + url)}\n
      üìò Facebook: https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(url)}&quote=${encodeURIComponent(title)}\n
      üê¶ Twitter: https://twitter.com/intent/tweet?text=${encodeURIComponent(title)}&url=${encodeURIComponent(url)}\n
    `;
    navigator.clipboard.writeText(url);
    alert(shareOptions + "\n(Link copied to clipboard ‚úÖ)");
  }
}

/* ============================
   BACK
============================ */
function goBack(){ showSection("home"); history.pushState({}, "News", window.location.pathname); }

// Copy UNIOSUN portal link
function copyPortalLink() {
  const portalLink = "https://admissions.uniosun.edu.ng/";
  navigator.clipboard.writeText(portalLink).then(() => {
    alert("UNIOSUN portal link copied to clipboard!");
  });
}

/* ============================
   PROFILE PAGE
============================ */

// Toggle profile modal
function toggleProfile() {
  const modal = document.getElementById('profilePage');
  modal.style.display = modal.style.display === 'none' ? 'flex' : 'none';
  if(modal.style.display === 'flex') loadUserProfile();
}

// Load current user profile from Supabase Auth
async function loadUserProfile() {
  const { data: { user }, error } = await supabase.auth.getUser();
  if (error) return console.error(error.message);
  if (!user) return alert("Please log in to view profile");

  document.getElementById('profileName').textContent = user.user_metadata?.full_name || 'No Name Set';
  document.getElementById('profileEmail').textContent = user.email;
  document.getElementById('profileCreated').textContent = `Member since: ${new Date(user.created_at).toLocaleDateString()}`;
}

// Edit profile (update full_name in Supabase Auth)
async function editProfile() {
  const { data: { user }, error } = await supabase.auth.getUser();
  if (!user) return alert("No user logged in");

  const newName = prompt("Enter your new full name:", user.user_metadata?.full_name || "");
  if (!newName) return;

  const { error: updateError } = await supabase.auth.updateUser({
    data: { full_name: newName }
  });

  if (updateError) return alert("Profile update failed: " + updateError.message);

  alert("Profile updated!");
  loadUserProfile();
}

// Logout
async function logoutUser() {
  const { error } = await supabase.auth.signOut();
  if (error) {
    return alert("Logout failed: " + error.message);
  }
  
  // Redirect to home page after logout
  window.location.href = "index.html";
}

/* ============================
   ANONYMOUS MESSAGES
============================ */

let anonPage = 0;
const anonPageSize = 5;

async function submitAnonymousMessage(event) {
  event.preventDefault();
  const textInput = document.getElementById("anonText");
  const fileInput = document.getElementById("anonFile");
  const previewBox = document.getElementById("anonPreview");

  if (!textInput.value.trim()) {
    alert("‚ö†Ô∏è Please type a message.");
    return;
  }

  let fileUrl = null;
  if (fileInput.files.length > 0) {
    const file = fileInput.files[0];
    const fileName = Date.now() + "_" + file.name;
    const { data, error } = await supabase.storage
      .from("anon_uploads")
      .upload(fileName, file);

    if (error) {
      console.error("‚ùå File upload failed:", error.message);
    } else {
      const { data: publicUrlData } = supabase
        .storage
        .from("anon_uploads")
        .getPublicUrl(fileName);

      fileUrl = publicUrlData.publicUrl;
    }
  }

  const { error } = await supabase.from("anonymous_messages").insert([
    { message: textInput.value.trim(), file_url: fileUrl, created_at: new Date().toISOString() }
  ]);

  if (error) {
    console.error("‚ùå Error saving anonymous message:", error.message);
    alert("‚ùå Error saving message: " + error.message);
    return;
  }

  textInput.value = "";
  fileInput.value = "";
  previewBox.style.display = "none";
  previewBox.innerHTML = "";

  anonPage = 0;
  loadAnonymousMessages(true);
}

function previewAnonymousMessage() {
  const textInput = document.getElementById("anonText");
  const fileInput = document.getElementById("anonFile");
  const previewBox = document.getElementById("anonPreview");

  let html = "";
  if (textInput.value.trim()) {
    html += `<p>${textInput.value.trim()}</p>`;
  }

  if (fileInput.files.length > 0) {
    const file = fileInput.files[0];
    if (file.type.startsWith("image/")) {
      html += `<img src="${URL.createObjectURL(file)}" style="max-width:100%; margin-top:8px;">`;
    } else {
      html += `<p>üìé ${file.name}</p>`;
    }
  }

  previewBox.innerHTML = html || "<p style='color:#777;'>Nothing to preview</p>";
  previewBox.style.display = "block";
}

async function loadAnonymousMessages(reset = false) {
  const msgList = document.getElementById("anonMessages");
  const loadMoreBtn = document.getElementById("loadMoreBtn");

  if (reset) {
    msgList.innerHTML = "";
    anonPage = 0;
  }

  const from = anonPage * anonPageSize;
  const to = from + anonPageSize - 1;

  const { data, error } = await supabase
    .from("anonymous_messages")
    .select("*")
    .order("id", { ascending: false })
    .range(from, to);

  if (error) {
    console.error("‚ùå Error loading anonymous messages:", error.message);
    return;
  }

  if (!data || data.length === 0) {
    if (anonPage === 0) {
      msgList.innerHTML = "<p style='color:#666;'>No messages yet. Be the first to post! üí¨</p>";
    }
    loadMoreBtn.style.display = "none";
    return;
  }

  data.forEach(msg => {
    let html = `<div class="anon-card"><p>${msg.message}</p>`;
    if (msg.file_url) {
      if (msg.file_url.match(/\.(jpg|jpeg|png|gif)$/i)) {
        html += `<img src="${msg.file_url}" alt="Attachment" style="max-width:100%; margin-top:8px;">`;
      } else {
        html += `<a href="${msg.file_url}" target="_blank">üìé Download File</a>`;
      }
    }
    if (msg.created_at) {
      const date = new Date(msg.created_at);
      html += `<p style="font-size:12px; color:#666; margin-top:6px;">üïí ${date.toLocaleString()}</p>`;
    }
    html += `</div>`;
    msgList.innerHTML += html;
  });

  loadMoreBtn.style.display = (data.length === anonPageSize) ? "block" : "none";
}

function loadMoreAnonymousMessages() {
  anonPage++;
  loadAnonymousMessages();
}

document.addEventListener("DOMContentLoaded", () => {
  loadAnonymousMessages(true);
});

/* ============================
   TAB SWITCHING
============================ */
function showCalc(id){
  document.querySelectorAll(".calc-box").forEach(box => box.style.display = "none");
  document.getElementById(id).style.display = "block";
}

/* ============================
   GPA / CGPA CALCULATOR
============================ */
const gradePoints = { "A": 5, "B": 4, "C": 3, "D": 2, "E": 1, "F": 0 };

function addCourse(semesterId) {
  const container = document.getElementById(semesterId);
  const div = document.createElement("div");
  div.className = "course-row";
  div.innerHTML = `
    <input type="number" min="1" placeholder="Units" class="units" style="width:70px;">
    <select class="grade">
      <option value="">Grade</option>
      <option value="A">A (70-100)</option>
      <option value="B">B (60-69)</option>
      <option value="C">C (50-59)</option>
      <option value="D">D (45-49)</option>
      <option value="E">E (40-44)</option>
      <option value="F">F (0-39)</option>
    </select>
  `;
  container.appendChild(div);
}

function calculateSemesterGPA(semesterId) {
  const rows = document.querySelectorAll(`#${semesterId} .course-row`);
  let totalUnits = 0, totalPoints = 0;

  rows.forEach(row => {
    const units = parseInt(row.querySelector(".units").value) || 0;
    const grade = row.querySelector(".grade").value;
    if (units > 0 && grade) {
      const gp = gradePoints[grade];
      totalUnits += units;
      totalPoints += gp * units;
    }
  });

  return { gpa: totalUnits > 0 ? (totalPoints / totalUnits) : 0, totalUnits, totalPoints };
}

function calculateCGPA() {
  const sem1 = calculateSemesterGPA("semester1");
  const sem2 = calculateSemesterGPA("semester2");

  const totalUnits = sem1.totalUnits + sem2.totalUnits;
  const totalPoints = sem1.totalPoints + sem2.totalPoints;

  const gpa1 = sem1.gpa.toFixed(2);
  const gpa2 = sem2.gpa.toFixed(2);
  const cgpa = totalUnits > 0 ? (totalPoints / totalUnits).toFixed(2) : 0;

  let classif = "";
  if (cgpa >= 4.5) classif = "üéâ First Class";
  else if (cgpa >= 3.5) classif = "üëç Second Class Upper";
  else if (cgpa >= 2.4) classif = "üëå Second Class Lower";
  else if (cgpa >= 1.5) classif = "üôÇ Third Class";
  else if (cgpa >= 1.0) classif = "üòÖ Pass";
  else classif = "‚ùå Fail";

  document.getElementById("cgpaResult").innerHTML = `
    Semester 1 GPA = <b>${gpa1}</b><br>
    Semester 2 GPA = <b>${gpa2}</b><br>
    üèÜ Final CGPA = <b>${cgpa}</b><br>
    Classification: <b>${classif}</b>
  `;
}

/* ============================
   AGGREGATE CALCULATOR
============================ */
const olevelPoints = { "A1": 8, "B2": 7, "B3": 6, "C4": 5, "C5": 4, "C6": 3, "D7": 2, "E8": 1, "F9": 0 };

function addOlevelInputs() {
  const container = document.getElementById("olevelGrades");
  container.innerHTML = ""; // reset
  for (let i = 1; i <= 5; i++) {
    const select = document.createElement("select");
    select.className = "olevel";
    select.innerHTML = `
      <option value="">Subject ${i} Grade</option>
      <option value="A1">A1</option>
      <option value="B2">B2</option>
      <option value="B3">B3</option>
      <option value="C4">C4</option>
      <option value="C5">C5</option>
      <option value="C6">C6</option>
      <option value="D7">D7</option>
      <option value="E8">E8</option>
      <option value="F9">F9</option>
    `;
    container.appendChild(select);
  }
}

function calculateAggregate() {
  const jamb = parseInt(document.getElementById("jambScore").value) || 0;
  const jambPercent = (jamb * 60) / 400;

  let olevelSum = 0;
  document.querySelectorAll("#olevelGrades .olevel").forEach(sel => {
    if (sel.value) olevelSum += olevelPoints[sel.value];
  });

  const total = jambPercent + olevelSum;

  document.getElementById("aggResult").innerHTML = `
    JAMB % = <b>${jambPercent.toFixed(2)}</b><br>
    O‚ÄôLevel % = <b>${olevelSum}</b><br>
    Final Screening Score = <b>${total.toFixed(2)}%</b>
  `;
}

// JS: add dynamic class to dropdown based on value
document.addEventListener("change", function(e) {
  if(e.target.classList.contains("grade-select")){
    const grade = e.target.value.toLowerCase();
    e.target.className = "grade-select " + grade;
  }
});

/* ============================
   GAMERS CONNECTIONS
============================ */
async function addGamertag(event, game) {
  event.preventDefault();
  const input = document.getElementById(game + "Input");
  const list = document.getElementById(game + "List");
  if (!input || !list) return;

  const username = input.value.trim();
  if (!username) return;

  const { error } = await supabase.from("gamers").insert([
    { "Game": game, "Username": username }
  ]);

  if (error) {
    console.error("‚ùå Error saving gamertag:", error.message);
    alert("‚ùå Error saving gamertag: " + error.message);
    return;
  }

  renderGamertag(username, game, list);
  input.value = "";
}

function renderGamertag(username, game, list) {
  const li = document.createElement("li");
  const span = document.createElement("span");
  span.textContent = username;

  span.style.cursor = "pointer";
  span.style.background = "var(--uni-green)";
  span.style.color = "#fff";
  span.style.padding = "6px 12px";
  span.style.borderRadius = "6px";
  span.style.fontSize = "14px";
  span.style.transition = "background 0.3s ease";

  span.onmouseover = () => { span.style.background = "var(--uni-green-2)"; };
  span.onmouseout = () => { span.style.background = "var(--uni-green)"; };

  span.onclick = () => {
    const g = game.toLowerCase();

    if (g === "codm") {
      navigator.clipboard.writeText(username);
      alert(`${username}'s CODM ID has been copied! Attempting to open CODM...`);
      window.open(`codm://joinroom?code=ROOM_CODE_HERE`, "_blank");

    } else if (g === "bloodstrike") {
      navigator.clipboard.writeText(username);
      alert(`${username}'s Blood Strike ID has been copied! Open Blood Strike and paste to connect.`);

    } else {
      const connect = confirm(
        `Do you want to connect with ${username} on ${game.toUpperCase()}?\nClick OK to copy their ID.`
      );
      if (connect) {
        navigator.clipboard.writeText(username);
        alert(`${username}'s ID has been copied! Open ${game.toUpperCase()} to add them.`);
      }
    }
  };

  li.appendChild(span);
  list.appendChild(li);
}

function normalizeGameName(game) {
  return game.toLowerCase().replace(/\s/g, "");
}

async function loadGamertags() {
  const { data, error } = await supabase
    .from("gamers")
    .select("*")
    .order("id", { ascending: false });

  if (error) {
    console.error("‚ùå Error loading gamertags:", error.message);
    return;
  }

  data.forEach((gamer) => {
    const gameId = normalizeGameName(gamer.Game) + "List";
    const list = document.getElementById(gameId);
    if (list) {
      renderGamertag(gamer.Username, gamer.Game, list);
    }
  });
}

document.addEventListener("DOMContentLoaded", loadGamertags);

/* ============================
   INIT
============================ */


window.onload = function(){
  const params = new URLSearchParams(window.location.search);
  if(params.has("id") && params.has("t")){
    openPost(params.get("id"), params.get("t"));
  } else {
    showSection("home");
    loadHomeNews();
    loadCampusGist();
    loadAcademicUpdates();
    loadPDFs();
  }
};

window.onpopstate = function(e){
  if(e.state && e.state.postId){ 
    openPost(e.state.postId, e.state.table); 
  } else { 
    goBack(); 
  }
};

</script>
</body>
</html>
